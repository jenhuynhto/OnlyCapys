[[extend 'layout.html']]

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OnlyCapys</title>
  <link rel="stylesheet" href="css/no.css">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
  <script type="module" src="./index.js"></script>
</head>

<div class="section">
  <div class="columns is-mobile" style="padding-top: 40px;">
    <div class="column is-half is-mobile" style="padding-top: 30px;">
      <div class="block">
        <!-- <img id="map" style="border-radius: 20px; width:90%; height: auto; " src="../static/images/tempmap.png" alt="Map of Santa Cruz, CA"> -->
        <style>

          #map {
            height: 500px;
            width: auto;
          
          }
        </style>
        <!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCz7rHQYL7rRV6ii-oX_9MWoghMDRoZSss"></script> -->
        <div id="map" class="is-loading"></div>
      </div>
      <div class="block" style="margin-top: 325px;">
        <h1 class="title is-size-3" style="font-weight: 700;">The Capybara
        </h1>
        <p>In the wetlands, only <em>one</em> remarkable creature reigns supreme — the capybara, nature's gentle giant.
          With their impressive size, sleek body, and playful nature, these charismatic beings
          captivate hearts.</p>
        <!-- Fun Facts #1 and #2 -->
        <div class="columns is-mobile" style="padding-left: 10px">
          <div class="column is half is-mobile">
            <span class="title is-size-5" style="font-weight: 700;">Fun Fact #1</span>
            <p>Capybaras are the largest rodents in the world! Reaching weights of up to 150lbs </p>
          </div>
          <div class="column is-mobile">
            <span class="title is-size-5" style="font-weight: 700;">Fun Fact #2</span>
            <p>Capybaras are great swimmers due to their webbed feet and streamlined bodies.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="column is-mobile">
      <h1 class="title is-size-3" style="font-weight: 700;">Locating Capybaras near you — easy, fast, and frictionless.</h1>
      <p>Explore a comprehensive interactive map that showcases capybara locations across the United States.
        Whether you're longing to see one in-person out of curiousity or simply seek capybara companionship, we've got
        you covered!
      </p>
      <h1 class="title is-size-4" style="font-weight: 700; margin-top: 40px;">Enter an address to start your capybara quest!</h1>
      <!-- Enter address here -->
      <form>
        <input type="text" id="userAddress" name="userAddress" placeholder="123 Capybara Ave., Santa Cruz, CA 95060">

      </form>
      <button class="button" style="background-color: #327bea; color: white; font-weight: 500; width: 120px;" onClick="updateMap()">
        Find Now
        <i class="fa fa-angle-right fa-fw" aria-hidden="true"></i>
      </button>

      <p>You inputted: <span id="result"></span></p>

      <div class="block" style="margin-top: 280px;">
        <img id="capybara1" style="border-radius: 20px; height: 400px; width: auto;"
          src="../static/images/capybara1.png" alt="Adult Capybara with 2 Baby Capybara">
      </div>
    </div>
  </div>
  <div class="capybara2" style="margin-top: 230px;">
    <p class="has-text-centered"><img id="capybara2" style="border-radius: 20px;" src="../static/images/capybara2.jpeg" alt="Adult Capybara with 5 Baby Capybara">
    </p>
  </div>

  <div class="columns is-mobile" style="margin-top: 50px;">
    <div class="column is-one-quarter is-mobile has-text-left">
      <span class="title is-size-5" style="font-weight: 700;">Peace</span>
      <p>Native to South America, capybaras can be found in countries such as Brazil, Venezuela, Colombia, and Paraguay.
      </p>
    </div>
    <div class="column is-mobile">
      <span class="title is-size-5" style="font-weight: 700;">Resilience</span>
      <p>Capybaras are social animals and live in groups of up to 20 individuals, although larger groups have been
        observed.</p>
    </div>
    <div class="column is-mobile">
      <span class="title is-size-5" style="font-weight: 700;">Calm</span>
      <p>Groups of capybaras are led by a dominant male, who protects the group and helps to raise the young.</p>
    </div>
    <div class="column is-mobile">
      <span class="title is-size-5" style="font-weight: 700;">Community</span>
      <p>Capybaras are social creatures, who long for connection and a sense
        of belonging through a community.
        <br><br>
        Similarly, we hope to bring together people through their love or even
        their slight interest of Capybaras to create lifelong friendships.</p>
    </div>
  </div>

  <div class="columns is-mobile" style="margin-top: 50px; margin-bottom: 15px; margin-left: 200px; margin-right: 200px;">
    <div class="column is-half is-mobile has-text-left">
      <div class="contact-form" style="margin-top: 30px; padding-right: 300px;">
        <h1 class="title is-size-2" style="font-weight: 700;">Contact Us</h1>
        [[=form]]
      </div>
    </div>
    <div class="column is-mobile has-text-left" style="margin-top: 155px;">
      <span class="title is-size-4" style="font-weight: 700;">Contact</span>
      <br>
      <span>onlycapys@gmail.com</span>
      <br>
      <br>
      <span class="title is-size-4" style="font-weight: 700; ">Based In</span>
      <br>
      <span>California</span>
    </div>
  </div>
</div>

[[block page_scripts]]
<script>
  function initMap() {
  var geocoder = new google.maps.Geocoder();

  // Get the user's IP geolocation data
  fetch('https://ipapi.co/json/')
    .then(function (response) {
      return response.json();
    })
    .then(function (data) {
      var userLat = data.latitude;
      var userLng = data.longitude;

      var map = new google.maps.Map(document.getElementById('map'), {
        center: { lat: userLat, lng: userLng },
        zoom: 4
      });

      fetch('https://raw.githubusercontent.com/jenhuynhto/cse183-final/main/apps/onlycapys/data/capybara_zoos.json')
        .then(function (response) {
          return response.json();
        })
        .then(function (data) {
          data.forEach(function (entry) {
            var marker = new google.maps.Marker({
              position: { lat: entry.lat, lng: entry.long },
              map: map,
              title: entry.zoo
            });
          });
        })
        .catch(function (error) {
          console.log('Error fetching JSON file:', error);
        });
    })
    .catch(function (error) {
      console.log('Error fetching user location:', error);
    });
  }



//   function initMap() {
//   var geocoder = new google.maps.Geocoder();

//   var locationName = "Santa Cruz, CA";

//   geocoder.geocode({ address: locationName }, function (results, status) {
//     if (status === google.maps.GeocoderStatus.OK) {
//       var map = new google.maps.Map(document.getElementById('map'), {
//         // center: {lat: 37.7749, lng: -122.4194}, // Specify the initial map center
//         center: results[0].geometry.location, // Use the first result's coordinates as the center
//         zoom: 7 // Lower number is zoomed out, higher number is zoomed in
//       });


//       fetch('https://raw.githubusercontent.com/jenhuynhto/cse183-final/main/apps/onlycapys/data/capybara_zoos.json') // Fetch the JSON file
//         .then(function (response) {
//           console.log(response)
//           return response.json(); // Parse the JSON data
//         })
//         .then(function (data) {
//           // Iterate over each entry in the JSON data
//           data.forEach(function (entry) {
//             var marker = new google.maps.Marker({
//               position: { lat: entry.lat, lng: entry.long }, // Use the entry's coordinates
//               map: map,
//               title: entry.zoo // Use the entry's zoo as the marker title
//             });
//           });
//         })
//         .catch(function (error) {
//           console.log('Error fetching JSON file:', error);
//         });
      
//       // var marker = new google.maps.Marker({
//       //   position: results[0].geometry.location,
//       //   map: map,
//       //   title: "Marker Title", // Optional: You can add a title to the marker       
//       // });

//       // var marker2 = new google.maps.Marker({
//       //   position: {lat: 37.7749, lng: -122.4194},
//       //   map: map,
//       //   title: "Marker Title" // Optional: You can add a title to the marker
//       // });
      
//     } else {
//       console.log('Geocode was not successful for the following reason: ' + status);
//     }
//   });
// }

function updateMap() {
  var geocoder = new google.maps.Geocoder();
  var locationName = document.getElementById("userAddress").value;
  document.getElementById("result").innerHTML = document.getElementById("userAddress").value;

  geocoder.geocode({ address: locationName }, function (results, status) {
    if (status === google.maps.GeocoderStatus.OK) {
      var map = new google.maps.Map(document.getElementById('map'), {
        center: results[0].geometry.location,
        zoom: 10
      });

      fetch('https://raw.githubusercontent.com/jenhuynhto/cse183-final/main/apps/onlycapys/data/capybara_zoos.json') // Fetch the JSON file
        .then(function (response) {
          return response.json(); // Parse the JSON data
        })
        .then(function (data) {
          data.forEach(function (entry) {
            var marker = new google.maps.Marker({
              position: { lat: entry.lat, lng: entry.long },
              map: map,
              title: entry.zoo
            });
          });
        })
        .catch(function (error) {
          console.log('Error fetching JSON file:', error);
        });
    } else {
      console.log('Geocode was not successful for the following reason: ' + status);
    }
  });
}

// function updateMap() {
//     var geocoder = new google.maps.Geocoder();
    
//     var locationName = document.getElementById("result").innerHTML;

//     geocoder.geocode({ address: locationName }, function (results, status) {
//       if (status === google.maps.GeocoderStatus.OK) {
//         var map = new google.maps.Map(document.getElementById('map'), {
//           // center: {lat: 37.7749, lng: -122.4194}, // Specify the initial map center
//           center: results[0].geometry.location, // Use the first result's coordinates as the center
//           zoom: 7 // Lower number is zoomed out, higher number is zoomed in
//         });

//       } else {
//         console.log('Geocode was not successful for the following reason: ' + status);
//       }
//     });
// }

</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCz7rHQYL7rRV6ii-oX_9MWoghMDRoZSss&callback=initMap"></script>
[[end]]